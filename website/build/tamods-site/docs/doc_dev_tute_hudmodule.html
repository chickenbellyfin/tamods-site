<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Tutorial - Writing a HUDModule · TAMods</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This tutorial will cover writing a custom HUD component for displaying your current speed, compatible with the Ubermenu preset."/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Tutorial - Writing a HUDModule · TAMods"/><meta property="og:type" content="website"/><meta property="og:url" content="http://www.tamods.org/index.html"/><meta property="og:description" content="This tutorial will cover writing a custom HUD component for displaying your current speed, compatible with the Ubermenu preset."/><meta property="og:image" content="http://www.tamods.org/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="http://www.tamods.org/img/docusaurus.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="alternate" type="application/atom+xml" href="http://www.tamods.org/blog/atom.xml" title="TAMods Blog ATOM Feed"/><link rel="alternate" type="application/rss+xml" href="http://www.tamods.org/blog/feed.xml" title="TAMods Blog RSS Feed"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/img-blank.png" alt="TAMods"/><h2 class="headerTitleWithLogo">TAMods</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/blog" target="_self">News</a></li><li class=""><a href="/docs/doc_user_install.html" target="_self">Get TAMods</a></li><li class="siteNavGroupActive"><a href="/docs/doc_dev_intro.html" target="_self">TAMods Docs</a></li><li class=""><a href="/docs/doc_srv_api_overview.html" target="_self">TAMods-Server Docs</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>Introduction</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul><li class="navListItem"><a class="navItem" href="/docs/doc_dev_intro.html">Introduction to Modding</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_tute_script.html">Tutorial - Writing a Script</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/doc_dev_tute_hudmodule.html">Tutorial - Writing a HUDModule</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Reference</h3><ul><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_overview.html">Overview</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_consolecommands.html">Console Commands</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_events.html">Event Handling and I/O</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_gameinfo.html">Game Information</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_ux.html">User Experience Features</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_model_proj.html">Model and Projectile Modification</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_routes.html">Capping and Route Recording</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_drawing.html">Drawing</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_datatypes.html">Miscellaneous Data Types</a></li><li class="navListItem"><a class="navItem" href="/docs/doc_dev_api_particlesystems.html">Particle Systems</a></li></ul></div></div></section></div><script>
            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              const headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                if (event.target.tagName === 'A') {
                  document.body.classList.remove('tocActive');
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Tutorial - Writing a HUDModule</h1></header><article><div><span><p>This tutorial will cover writing a custom HUD component for displaying your current speed, compatible with the Ubermenu preset.</p>
<p>It is assumed you have TAMods and the Ubermenu working, and that you are familiar with customising the HUD in-game via the Ubermenu.</p>
<h2><a class="anchor" aria-hidden="true" id="part-1-setting-up-your-hudmodule-script"></a><a href="#part-1-setting-up-your-hudmodule-script" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Part 1: Setting up your hudmodule script</h2>
<p>Custom HUD component scripts must be stored within the Ubermenu preset, at <code>&lt;Documents&gt;/My Games/Tribes Ascend/TribesGame/config/presets/ubermenu/hudmodules</code>. Navigate to this directory and create a new file called <code>Tutorial_Speedbar.lua</code>.</p>
<h3><a class="anchor" aria-hidden="true" id="adding-the-skeleton"></a><a href="#adding-the-skeleton" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding the skeleton</h3>
<p>In this file, we'll first add the skeleton information that the Ubermenu needs for our HUDModule. The following is an annotated HUDModule skeleton; add it into your <code>Tutorial_Speedbar.lua</code>.</p>
<pre><code class="hljs css languages- lua"><span class="hljs-comment">-- The module object contains all the information about our custom HUD module</span>
<span class="hljs-keyword">local</span> module = {}

<span class="hljs-comment">-- The name of the module - this must be the same as the filename without .lua on the end</span>
module.name = <span class="hljs-string">"Tutorial_Speedbar"</span> 
<span class="hljs-comment">-- The module.opts object will hold all the options for users to configure in the Ubermenu</span>
module.opts = {}

<span class="hljs-comment">-- The module.draw function is where we'll write the drawing logic for our module</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">module.draw</span><span class="hljs-params">(res_x, res_y)</span></span>

<span class="hljs-keyword">end</span>

<span class="hljs-comment">-- Our script should return the module at the very end of the file</span>
<span class="hljs-keyword">return</span> module
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="drawing-hello-world"></a><a href="#drawing-hello-world" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Drawing &quot;Hello World&quot;</h3>
<p>Now we have the skeleton, we can make our script draw something! To test that we've set things up correctly, let's start by simply drawing the text &quot;Hello World&quot;.</p>
<p>Add the following inside the <code>module.draw</code> function:</p>
<pre><code class="hljs css languages- lua">drawSmallText(<span class="hljs-string">"Hello World"</span>, rgb(<span class="hljs-number">255</span>, <span class="hljs-number">255</span>, <span class="hljs-number">255</span>), <span class="hljs-number">10</span>, <span class="hljs-number">10</span>, enums.TEXT_ALIGN_LEFT, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
</code></pre>
<p>This draw command will draw the text <code>Hello World</code> in white in the console font, at pixel position <code>(10, 10)</code> on the screen.</p>
<h3><a class="anchor" aria-hidden="true" id="testing-it-out"></a><a href="#testing-it-out" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Testing it out</h3>
<p>To test this out, open the game, enter Roam Map, and open up the Ubermenu. Under <code>HUD Maker &gt; Add Module</code>, you should now see an entry labelled <code>Tutorial Speedbar</code>. Adding this module should cause &quot;Hello World&quot; to appear in the top left of the screen, as in the following:</p>
<p><img src="/docs/assets/doc_dev_tute_hudmodule-1.png" alt="Hello world displayed on the screen"></p>
<p>If adding your module caused Lua errors to display in the console, then your script is incorrect. You will have to fix your script and use <code>/reloadconfig</code> to reload it before you can try adding it again.</p>
<h2><a class="anchor" aria-hidden="true" id="part-2-writing-a-custom-speedbar-script"></a><a href="#part-2-writing-a-custom-speedbar-script" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Part 2: Writing a custom speedbar script</h2>
<p>You can remove the <code>drawSmallText</code> call from your script. We will now make the script display a custom speedbar.</p>
<h3><a class="anchor" aria-hidden="true" id="adding-module-options"></a><a href="#adding-module-options" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Adding module options</h3>
<p>First, we'll add some options for the user to set to customise the speedbar. Add the following into your script, directly under where <code>module.opts</code> is assigned:</p>
<pre><code class="hljs css languages- lua">module.opts.X_Position          = <span class="hljs-number">5</span>
module.opts.Y_Position          = <span class="hljs-number">40</span>
module.opts.Width               = <span class="hljs-number">30</span>
module.opts.Height              = <span class="hljs-number">200</span>
module.opts.Max_Speed_Color     = rgb(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
module.opts.Min_Speed_Color     = rgb(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">196</span>)
module.opts.Background_Color    = rgba(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">125</span>)
</code></pre>
<p>We're adding options for the user customise the <code>X</code> and <code>Y</code> placement of the bar, its <code>Width</code> and <code>Height</code>, as well as the colours used.</p>
<p>Note that by convention, <code>X</code> and <code>Y</code> positions for HUDModules should represent a <em>percentage</em> of the screen width/height. This will allow your module to display in the same place regardless of what resolution you play the game at. For this script however, the <code>Width</code> and <code>Height</code> will be in pixels.</p>
<h3><a class="anchor" aria-hidden="true" id="calculating-values"></a><a href="#calculating-values" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Calculating values</h3>
<p>Now we need to write our <code>module.draw</code> function to actually display the speedbar. First, we need to calculate the values we need for displaying it.</p>
<p>Inside <code>module.draw</code>, add the following statements to ensure we only draw the speedbar when the player is alive and is skiing (or is in a vehicle):</p>
<pre><code class="hljs css languages- lua"><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> hud_data.alive <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">end</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> hud_data.vehicle <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> player.isSkiing() <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">end</span>
</code></pre>
<p>The <code>hud_data</code> variable is provided by Ubermenu to give access to particular parts of game information (e.g. whether the player is alive) without having to call <code>player.isAlive()</code> yourself. Ubermenu checks the status once and exposes the value to all modules via <code>hud_data</code> because there may be many different modules that <em>all</em> need to know whether the player is alive.</p>
<p>These lines will cause the <code>module.draw</code> function to exit early, without drawing anything, in the event the player is dead or is not skiing/in a vehicle.</p>
<p>Next, we will calculate the pixel positions we will use for drawing:</p>
<pre><code class="hljs css languages- lua"><span class="hljs-comment">-- We're using the X_Position and Y_Position options as percentages, so we need to calculate the pixel values for them</span>
<span class="hljs-keyword">local</span> xpos = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">floor</span>(module.opts.X_Position / <span class="hljs-number">100</span> * res_x)
<span class="hljs-keyword">local</span> ypos = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">floor</span>(module.opts.Y_Position / <span class="hljs-number">100</span> * res_y)
<span class="hljs-comment">-- Calculating the right, bottom and middle positions of the bar for use in drawing</span>
<span class="hljs-keyword">local</span> xright = xpos + module.opts.Width
<span class="hljs-keyword">local</span> ybottom = ypos + module.opts.Height
<span class="hljs-keyword">local</span> xmiddle = xpos + module.opts.Width / <span class="hljs-number">2</span>
</code></pre>
<p>Next up, we will figure out what proportion of the bar we need to fill, based on the current speed:</p>
<pre><code class="hljs css languages- lua"><span class="hljs-comment">-- Get the current speed</span>
<span class="hljs-keyword">local</span> curSpeed = hud_data.vehicle <span class="hljs-keyword">and</span> vehicle.speed() <span class="hljs-keyword">or</span> player.speed()
<span class="hljs-keyword">local</span> minVal = <span class="hljs-number">50</span>
<span class="hljs-keyword">local</span> maxVal = <span class="hljs-number">300</span>
<span class="hljs-comment">-- If the user has set custom min/max values for the default speedbars, let's use those</span>
<span class="hljs-keyword">if</span> skiBarMin <span class="hljs-keyword">and</span> skiBarMax <span class="hljs-keyword">then</span>
    minVal = skiBarMin
    maxVal = skiBarMax
<span class="hljs-keyword">end</span>
<span class="hljs-comment">-- Calculate the proportion of the way between minVal and maxVal that the player's speed is</span>
<span class="hljs-comment">-- But we will clamp the result between 0 and 1 </span>
<span class="hljs-keyword">local</span> pct = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">math</span>.<span class="hljs-built_in">min</span>(<span class="hljs-number">1</span>, (curSpeed - minVal) / (maxVal - minVal)))
</code></pre>
<p>Finally, we'll calculate the colour of our speedbar, by linearly interpolating between the minimum speed colour and the maximum speed colour:</p>
<pre><code class="hljs css languages- lua"><span class="hljs-keyword">local</span> barColor = lerpColor(module.opts.Min_Speed_Color, module.opts.Max_Speed_Color, pct)
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="drawing-the-speedbars"></a><a href="#drawing-the-speedbars" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Drawing the speedbars</h3>
<p>Now that we've calculated the values we need, we can actually draw our speedbars. First we'll draw a background and a border for our speedbar:</p>
<pre><code class="hljs css languages- lua"><span class="hljs-comment">-- Draw the background</span>
drawRect(xpos, ypos, xright, ybottom, module.opts.Background_Color)
<span class="hljs-comment">-- Draw a border</span>
drawBox(xpos, ypos, xright, ybottom, barColor)
</code></pre>
<p>Next we'll draw the bar itself:</p>
<pre><code class="hljs css languages- lua">drawProgressBar(xpos + <span class="hljs-number">4</span>, ypos + <span class="hljs-number">4</span>, xright - <span class="hljs-number">4</span>, ybottom - <span class="hljs-number">4</span>, barColor, <span class="hljs-number">0</span>, pct)
</code></pre>
<p>The above command will draw our speedbar inside our border; the second last parameter specifies the direction of the bar (the bar fills upwards in our case).</p>
<p>And finally, we'll draw the player's actual speed underneath the bar:</p>
<pre><code class="hljs css languages- lua">textSize = getUTTextSize(curSpeed, <span class="hljs-number">1</span>)
drawUTText(curSpeed, barColor, xmiddle, ybottom + <span class="hljs-number">2</span> + textSize.y / <span class="hljs-number">2</span>, enums.TEXT_ALIGN_CENTER, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
</code></pre>
<p>Here we are drawing the speed using an Unreal Tournament font; we've gotten the drawing size of the text so that we can offset its Y position to prevent it clipping into the bar.</p>
<h3><a class="anchor" aria-hidden="true" id="testing-the-module"></a><a href="#testing-the-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Testing the module</h3>
<p>The script is now complete. Try it out in the game and fix any errors (you can see the full, correct script <a href="#the-final-script">below</a>). It should look something like the following screenshots:</p>
<p><img src="/docs/assets/doc_dev_tute_hudmodule-2.png" alt="Custom speedbar displayed on the screen"></p>
<p>You've now written your first HUDModule! All HUDModules should use the same skeleton as this one; you can vary the options you present and the code in the <code>module.draw</code> function to display other things, and combine them with other TAMods features to build more complex custom HUDs.</p>
<h2><a class="anchor" aria-hidden="true" id="the-final-script"></a><a href="#the-final-script" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>The final script</h2>
<pre><code class="hljs css languages- lua"><span class="hljs-keyword">local</span> module = {}

module.name                     = <span class="hljs-string">"Tutorial_Speedbar"</span>
module.opts                     = {}
module.opts.X_Position          = <span class="hljs-number">5</span>
module.opts.Y_Position          = <span class="hljs-number">40</span>
module.opts.Width               = <span class="hljs-number">30</span>
module.opts.Height              = <span class="hljs-number">200</span>
module.opts.Max_Speed_Color     = rgb(<span class="hljs-number">255</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)
module.opts.Min_Speed_Color     = rgb(<span class="hljs-number">0</span>, <span class="hljs-number">255</span>, <span class="hljs-number">196</span>)
module.opts.Background_Color    = rgba(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">125</span>)

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">module.draw</span><span class="hljs-params">(res_x, res_y)</span></span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> hud_data.alive <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> hud_data.vehicle <span class="hljs-keyword">and</span> <span class="hljs-keyword">not</span> player.isSkiing() <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">end</span>

    <span class="hljs-keyword">local</span> xpos = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">floor</span>(module.opts.X_Position / <span class="hljs-number">100</span> * res_x)
    <span class="hljs-keyword">local</span> ypos = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">floor</span>(module.opts.Y_Position / <span class="hljs-number">100</span> * res_y)
    <span class="hljs-keyword">local</span> xright = xpos + module.opts.Width
    <span class="hljs-keyword">local</span> ybottom = ypos + module.opts.Height
    <span class="hljs-keyword">local</span> xmiddle = xpos + module.opts.Width / <span class="hljs-number">2</span>
    
    <span class="hljs-keyword">local</span> curSpeed = hud_data.vehicle <span class="hljs-keyword">and</span> vehicle.speed() <span class="hljs-keyword">or</span> player.speed()
    <span class="hljs-keyword">local</span> minVal = <span class="hljs-number">50</span>
    <span class="hljs-keyword">local</span> maxVal = <span class="hljs-number">300</span>
    <span class="hljs-keyword">if</span> skiBarMin <span class="hljs-keyword">and</span> skiBarMax <span class="hljs-keyword">then</span>
        minVal = skiBarMin
        maxVal = skiBarMax
    <span class="hljs-keyword">end</span> 
    <span class="hljs-keyword">local</span> pct = <span class="hljs-built_in">math</span>.<span class="hljs-built_in">max</span>(<span class="hljs-number">0</span>, <span class="hljs-built_in">math</span>.<span class="hljs-built_in">min</span>(<span class="hljs-number">1</span>, (curSpeed - minVal) / (maxVal - minVal)))

    <span class="hljs-keyword">local</span> barColor = lerpColor(module.opts.Min_Speed_Color, module.opts.Max_Speed_Color, pct)
    
    drawRect(xpos, ypos, xright, ybottom, module.opts.Background_Color)
    drawBox(xpos, ypos, xright, ybottom, barColor)
    
    drawProgressBar(xpos + <span class="hljs-number">4</span>, ypos + <span class="hljs-number">4</span>, xright - <span class="hljs-number">4</span>, ybottom - <span class="hljs-number">4</span>, barColor, <span class="hljs-number">0</span>, pct)
    
    textSize = getUTTextSize(curSpeed, <span class="hljs-number">1</span>)
    drawUTText(curSpeed, barColor, xmiddle, ybottom + <span class="hljs-number">2</span> + textSize.y / <span class="hljs-number">2</span>, enums.TEXT_ALIGN_CENTER, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)
<span class="hljs-keyword">end</span>

<span class="hljs-keyword">return</span> module
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/doc_dev_tute_script.html">← Tutorial - Writing a Script</a><a class="docs-next button" href="/docs/doc_dev_api_overview.html">Overview →</a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#part-1-setting-up-your-hudmodule-script">Part 1: Setting up your hudmodule script</a><ul class="toc-headings"><li><a href="#adding-the-skeleton">Adding the skeleton</a></li><li><a href="#drawing-hello-world">Drawing &quot;Hello World&quot;</a></li><li><a href="#testing-it-out">Testing it out</a></li></ul></li><li><a href="#part-2-writing-a-custom-speedbar-script">Part 2: Writing a custom speedbar script</a><ul class="toc-headings"><li><a href="#adding-module-options">Adding module options</a></li><li><a href="#calculating-values">Calculating values</a></li><li><a href="#drawing-the-speedbars">Drawing the speedbars</a></li><li><a href="#testing-the-module">Testing the module</a></li></ul></li><li><a href="#the-final-script">The final script</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/img-blank.png" alt="TAMods" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/en/doc_user_install.html">Get TAMods</a><a href="/docs/en/doc_dev_intro.html">TAMods Documentation</a><a href="/docs/en/doc_srv_api_overview.html">TAMods-Server Documentation</a></div><div><h5>Community</h5><a href="http://www.reddit.com/r/tribes" target="_blank" rel="noreferrer noopener">Tribes Subreddit</a><a href="https://discord.gg/ySkx6Cg" target="_blank" rel="noreferrer noopener">Australian Tribes Discord</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/mcoot/tamods-site">Site GitHub</a></div></section><section class="copyright">Copyright © 2019 TAMods Team</section></footer></div></body></html>